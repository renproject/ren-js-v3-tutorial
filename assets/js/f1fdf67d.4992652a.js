"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8064],{562:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return i},metadata:function(){return d},toc:function(){return f}});var r=n(87462),s=n(63366),a=(n(67294),n(3905)),o=n(93454),c=n(78602),u=["components"],i={title:"Query 24h fees",tag:"test"},l=void 0,d={unversionedId:"24h-fees",id:"24h-fees",title:"Query 24h fees",description:"In order to get the 24h fees earned by RenVM, you'll need to fetch the current all-time fees, and the all-time fees from 24 hours ago, and subtract the two.",source:"@site/stats/24h-fees.mdx",sourceDirName:".",slug:"/24h-fees",permalink:"/ren-client-docs/stats/24h-fees",editUrl:"https://github.com/renproject/ren-client-docs/edit/master/stats/24h-fees.mdx",tags:[],version:"current",frontMatter:{title:"Query 24h fees",tag:"test"},sidebar:"subgraph",previous:{title:"Darknode Stats",permalink:"/ren-client-docs/stats/darknode-stats"}},f=[],p={toc:f};function m(e){var t=e.components,n=(0,s.Z)(e,u);return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(o.G,{type:o.e.HowTo,mdxType:"DocTag"}),(0,a.kt)("p",null,"In order to get the 24h fees earned by RenVM, you'll need to fetch the current all-time fees, and the all-time fees from 24 hours ago, and subtract the two."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"const currentTimestamp = Math.floor(Date.now() / 1000);\n> 1628130330\nconst previousTimestamp = currentTimestamp - (24 * 60 * 60)\n> 1628043930\n")),(0,a.kt)(c.k,{url:"https://stats.renproject.io",defaultQuery:'{\n  current: Snapshot(timestamp: "1628130330") {\n    fees {\n      asset\n      amount\n    }\n    prices {\n      asset\n      priceInUsd\n      decimals\n    }\n  }\n  dayAgo: Snapshot(timestamp: "1628043930") {\n    fees {\n      asset\n      amount\n    }\n  }\n}',mdxType:"GraphQL"}),(0,a.kt)("p",null,"You can then loop each asset to get the difference:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"// Get the fees collected as of 24 hours ago\nconst dayAgo = response.data.dayAgo.fees.reduce(\n  (acc, fees) => ({ ...acc, [fees.asset]: fees.amount }),\n  {}\n);\n\n// Get the current fees collected\nconst current = response.data.current.fees.reduce(\n  (acc, fees) => ({ ...acc, [fees.asset]: fees.amount }),\n  {}\n);\n\n// Get the latest prices\nconst prices = response.data.current.prices.reduce(\n  (acc, prices) => ({ ...acc, [prices.asset]: prices }),\n  {}\n);\n\nconst assets = Object.keys(current);\n\n// Sum up the difference for each asset, converted to USD.\nconst oneDayFees = assets.reduce((acc, asset) => {\n  const difference = current[asset] - (dayAgo[asset] || 0);\n  const differentInUsd =\n    (difference / 10 ** prices[asset].decimals) * prices[asset].priceInUsd;\n  return acc + (differentInUsd || 0);\n}, 0);\n\n// Print the sum in USD, with two decimals.\nconsole.log(oneDayFees.toFixed(2));\n")))}m.isMDXComponent=!0},93454:function(e,t,n){n.d(t,{G:function(){return c},e:function(){return s}});var r,s,a=n(67294);!function(e){e.Tutorial="Tutorial",e.HowTo="How To",e.Reference="Reference",e.Explanation="Explanation"}(s||(s={}));var o=((r={})[s.Tutorial]="#b48ead",r[s.HowTo]="#69a8b9",r[s.Reference]="#bf616a",r[s.Explanation]="#d2b06c",r),c=function(e){var t=e.type,n=e.marginBottom;return a.createElement(a.Fragment,null,a.createElement("span",{style:{border:"2px solid "+o[t]||0,borderRadius:"5px",color:o[t]||"orange",padding:"0.1rem 0.4rem",marginBottom:void 0!==n?n:30,display:"inline-block"}},String(t)))}},78602:function(e,t,n){n.d(t,{k:function(){return o}});var r=n(67294),s=n(91262),a=function(e){var t=e.url,s=e.defaultQuery,a=e.docExplorerOpen,o=e.minHeight;if("undefined"==typeof window)return null;var c=n(53414).createGraphiQLFetcher,u=n(57932).ZP,i=c({url:t});return r.createElement("div",{style:{height:o||500}},r.createElement(r.Suspense,{fallback:r.createElement("div",null,"Loading...")},r.createElement(u,{docExplorerOpen:a,query:s,fetcher:i})))},o=function(e){return"undefined"==typeof window?null:r.createElement(s.Z,null,(function(){return r.createElement(r.Fragment,null,r.createElement(a,e),r.createElement("br",null))}))}}}]);